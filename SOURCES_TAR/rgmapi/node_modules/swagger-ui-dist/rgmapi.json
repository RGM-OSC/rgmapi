{
  "openapi": "3.0.3",
  "info": {
    "title": "RGMApi",
    "version": "2.0",
    "contact": {
      "email": "contact@rgm.cloud.com",
      "name": "Contact RGM",
      "url": "https://www.rgm-cloud.com/"
    },
    "description": "RGM includes a web-based \"RESTful\" API (Application Programming Interface) called RGMAPI that enables external programs to access information from the monitoring database and to manipulate objects inside the databases of RGM suite."
  },
  "tags": [
    {
      "name": "Authentication",
      "description": "Routes dedicated to authentication"
    },
    {
      "name": "Nagios",
      "description": "Nagios dedicated routes"
    },
    {
      "name": "Oneliner",
      "description": "Oneliner routes"
    },
    {
      "name": "LiveStatus",
      "description": "LiveStatus routes"
    },
    {
      "name": "Host",
      "description": "Host routes"
    },
    {
      "name": "Hostgroup",
      "description": "Hostgroup routes"
    },
    {
      "name": "Service",
      "description": "Service routes"
    },
    {
      "name": "Command",
      "description": "Command routes"
    },
    {
      "name": "Contact",
      "description": "Contact routes"
    },
    {
      "name": "Template",
      "description": "Template routes"
    },
    {
      "name": "User",
      "description": "User routes"
    },
    {
      "name": "Downtimes",
      "description": "Downtimes routes"
    },
    {
      "name": "Deprecated",
      "description": "Routes or methods that should not be used anymore. Will be suppressed in a next release"
    },
    {
      "name": "Testing",
      "description": "For testing purpose"
    }
  ],
  "paths": {
    "/api/v2/token": {
      "post": {
        "operationId": "getAuthToken",
        "summary": "Get a new authentication token",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "username": {
                    "type": "string"
                  },
                  "password": {
                    "type": "string",
                    "format": "password"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "version": {
                      "type": "string",
                      "example": "2.0"
                    },
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "200 OK"
                    },
                    "token": {
                      "type": "string",
                      "example": "661005f91b08526f032ff750b365d646af54e694452fc6863e2fc390ff799fcaa6fe8861df10cf2b98dc83378cafd006113efb86d35dfa6f634833be86bc45e0"
                    },
                    "valid_until_1970": {
                      "type": "integer",
                      "format": "int64",
                      "example": 1630680039
                    },
                    "valid_until_rfc": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "version": {
                      "type": "string",
                      "example": "2.0"
                    },
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "Wrong credentials (invalid username or password)"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "operationId": "checkAuthToken",
        "summary": "Check authentication token validity",
        "tags": [
          "Authentication"
        ],
        "parameters": [
          {
            "$ref": "#/components/headers/token"
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "401": {
            "description": "unauthorized"
          }
        }
      }
    },
    "/api/v2/host": {
      "get": {
        "operationId": "getHost",
        "summary": "Get host list",
        "tags": [
          "Host"
        ],
        "parameters": [
          {
            "$ref": "#/components/headers/token"
          },
          {
            "in": "query",
            "name": "token",
            "description": "The token",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "hostName",
            "description": "The hostname",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    },
    "/api/v2/nagios/resources": {
      "get": {
        "operationId": "getResources",
        "summary": "Get Nagios ressources list",
        "tags": [
          "Nagios"
        ],
        "parameters": [
          {
            "$ref": "#/components/headers/token"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "put": {
        "operationId": "modifyNagiosResources",
        "summary": "Modify one or many Nagios Resources",
        "tags": [
          "Nagios"
        ],
        "parameters": [
          {
            "$ref": "#/components/headers/token"
          },
          {
            "name": "username",
            "in": "query",
            "description": "Resources a JSON structure that reflects the resources to modify",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/NagiosRessource"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    },
    "/api/v2/nagios/export": {
      "post": {
        "operationId": "exportConfiguration",
        "summary": "Exports Lilac configuration to Nagios config file",
        "tags": [
          "Nagios"
        ],
        "parameters": [
          {
            "$ref": "#/components/headers/token"
          },
          {
            "name": "error",
            "in": "query",
            "description": "a string reference to notify on error",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "success",
            "in": "query",
            "description": "a string reference to notify on success",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "jobName",
            "in": "query",
            "description": "the export job name as stored into Lilac export table",
            "schema": {
              "type": "string",
              "default": "nagios"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    },
    "/api/v2/testing/{test}": {
      "get": {
        "operationId": "testGetWithParam",
        "summary": "Test route with path parameter",
        "tags": [
          "Testing"
        ],
        "parameters": [
          {
            "$ref": "#/components/headers/token"
          },
          {
            "in": "path",
            "name": "test",
            "required": true,
            "description": "Someting like an optional ID",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "in": "query",
            "name": "q",
            "description": "A value to test",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ResponseOK": {
        "type": "object",
        "properties": {
          "version": {
            "type": "string",
            "example": "2.0"
          },
          "code": {
            "type": "integer",
            "example": 200
          },
          "message": {
            "type": "string",
            "example": "200 OK"
          },
          "status": {
            "type": "string",
            "example": "authorized"
          },
          "result": {
            "type": "array",
            "items": {
              "type": "object"
            }
          }
        }
      },
      "ResponseUnauthorized": {
        "type": "object",
        "properties": {
          "version": {
            "type": "string",
            "example": "2.0"
          },
          "code": {
            "type": "integer",
            "example": 401
          },
          "message": {
            "type": "string",
            "example": "401 Unauthorized"
          },
          "status": {
            "type": "string",
            "example": "unauthorized"
          }
        }
      },
      "NagiosRessource": {
        "type": "object",
        "properties": {
          "resources": {
            "type": "object",
            "example": {
              "User1": "value1",
              "User9": "value9"
            }
          }
        }
      }
    },
    "headers": {
      "token": {
        "in": "header",
        "name": "X-RGM-Token",
        "description": "RGMApi token",
        "required": true,
        "schema": {
          "type": "string"
        }
      }
    },
    "responses": {
      "200": {
        "description": "OK",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ResponseOK"
            }
          }
        }
      },
      "401": {
        "description": "unauthorized",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ResponseUnauthorized"
            }
          }
        }
      }
    }
  }
}