{
  "openapi": "3.0.3",
  "info": {
    "title": "RGMApi",
    "version": "2.0",
    "contact": {
      "email": "contact@rgm.cloud.com",
      "name": "Contact RGM",
      "url": "https://www.rgm-cloud.com/"
    },
    "description": "RGM includes a web-based \"RESTful\" API (Application Programming Interface) called RGMAPI that enables external programs to access information from the monitoring database and to manipulate objects inside the databases of RGM suite.\n\nTo authenticate, use your personnal token or request a token via the **POST** request `/api/v2/token` and past the token in the Autorize Window "
  },
  "tags": [
    {
      "name": "Authentication",
      "description": "Routes dedicated to authentication"
    },
    {
      "name": "Nagios",
      "description": "Nagios dedicated routes"
    },
    {
      "name": "Oneliner",
      "description": "Oneliner routes"
    },
    {
      "name": "LiveStatus",
      "description": "LiveStatus routes"
    },
    {
      "name": "Host",
      "description": "Host routes"
    },
    {
      "name": "Hostgroup",
      "description": "Hostgroup routes"
    },
    {
      "name": "Service",
      "description": "Service routes"
    },
    {
      "name": "Command",
      "description": "Command routes"
    },
    {
      "name": "Contact",
      "description": "Contact routes"
    },
    {
      "name": "Template",
      "description": "Template routes"
    },
    {
      "name": "User",
      "description": "User routes"
    },
    {
      "name": "Downtimes",
      "description": "Downtimes routes"
    },
    {
      "name": "Deprecated",
      "description": "Routes or methods that should not be used anymore. Will be suppressed in a next release"
    },
    {
      "name": "Testing",
      "description": "For testing purpose"
    }
  ],
  "security": [
    {
      "BearerAuth": []
    }
  ],
  "paths": {
    "/api/v2/token": {
      "post": {
        "operationId": "getAuthToken",
        "summary": "Get a new authentication token",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "username": {
                    "type": "string"
                  },
                  "password": {
                    "type": "string",
                    "format": "password"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "version": {
                      "type": "string",
                      "example": "2.0"
                    },
                    "code": {
                      "type": "integer",
                      "example": 201
                    },
                    "message": {
                      "type": "string",
                      "example": "201 Created"
                    },
                    "token": {
                      "type": "string",
                      "example": "661005f91b08526f032...45e0"
                    },
                    "valid_until_1970": {
                      "type": "integer",
                      "format": "int64",
                      "example": 1630680039
                    },
                    "valid_until_rfc": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "version": {
                      "type": "string",
                      "example": "2.0"
                    },
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "Wrong credentials (invalid username or password)"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "operationId": "checkAuthToken",
        "summary": "Check authentication token validity",
        "tags": [
          "Authentication"
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "401": {
            "description": "unauthorized"
          }
        }
      }
    },
    "/api/v2/host": {
      "get": {
        "operationId": "getHost",
        "summary": "Get host list",
        "tags": [
          "Host"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "hostName",
            "description": "The hostname",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "put": {
        "operationId": "modifyHost",
        "summary": "Modify an Host object",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required value is **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HostUpdate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/201"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "post": {
        "operationId": "createHost",
        "summary": "Create a Lilac Host object",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **templateHostName**\n   - **hostName**\n   - **hostIp**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HostCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/201"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "delete": {
        "operationId": "deleteHost",
        "summary": "delete an host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required value is **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HostBase"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          }
        }
      }
    },
    "/api/v2/host/group": {
      "post": {
        "operationId": "addHostGroupToHost",
        "summary": "Add Host Groupe to Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **hostGroupName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "hostGroupName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/201"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "delete": {
        "operationId": "deleteHostGroupToHost",
        "summary": "Delete a Host Group for an Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **hostGroupName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "hostGroupName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          }
        }
      }
    },
    "/api/v2/host/contact": {
      "post": {
        "operationId": "addContactToHost",
        "summary": "Add Contact to Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **contactName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "contactName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/201"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "delete": {
        "operationId": "deleteContactToHost",
        "summary": "Delete a Contact for an Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **contactName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "contactName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          }
        }
      }
    },
    "/api/v2/host/contact/group": {
      "post": {
        "operationId": "addContactGroupToHost",
        "summary": "Add a Contact Group to Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **contactGroupName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "contactGroupName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/201"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "delete": {
        "operationId": "deleteContactGroupToHost",
        "summary": "Delete a Contact Group for an Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **contactGroupName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "contactGroupName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          }
        }
      }
    },
    "/api/v2/host/template": {
      "post": {
        "operationId": "addHostTemplateToHost",
        "summary": "Add Host Template to Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **templateHostName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "templateHostName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/201"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "delete": {
        "operationId": "deleteHostTemplateToHost",
        "summary": "Delete a Host Template for an Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **templateHostName**\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "templateHostName": {
                    "type": "string"
                  }
                },
                "allOf": [
                  {
                    "$ref": "#/components/schemas/HostBase"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          }
        }
      }
    },
    "/api/v2/host/down": {
      "get": {
        "operationId": "getHostsDown",
        "summary": "Get a list of all down Hosts",
        "tags": [
          "Host"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    },
    "/api/v2/host/arguments": {
      "post": {
        "operationId": "addCustomArgumentsToHost",
        "summary": "Add Custom Arguments to Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **customArguments** as key:value form.\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "hostName": {
                    "type": "string"
                  },
                  "customArguments": {
                    "type": "object",
                    "additionalProperties": {}
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/201"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "delete": {
        "operationId": "deleteCustomArgumentsToHost",
        "summary": "Delete Custom Arguments for an Host",
        "tags": [
          "Host"
        ],
        "requestBody": {
          "description": "Required values are:\n   - **customArguments** as key:value form. value coould be \"\"\n   - **hostName**",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "hostName": {
                    "type": "string"
                  },
                  "customArguments": {
                    "type": "object",
                    "additionalProperties": {}
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          }
        }
      }
    },
    "/api/v2/nagios/resources": {
      "get": {
        "operationId": "getResources",
        "summary": "Get Nagios ressources list",
        "tags": [
          "Nagios"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      },
      "put": {
        "operationId": "modifyNagiosResources",
        "summary": "Modify one or many Nagios Resources",
        "tags": [
          "Nagios"
        ],
        "parameters": [
          {
            "name": "username",
            "in": "query",
            "description": "Resources a JSON structure that reflects the resources to modify",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/NagiosRessource"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    },
    "/api/v2/nagios/export": {
      "post": {
        "operationId": "exportConfiguration",
        "summary": "Exports Lilac configuration to Nagios config file",
        "tags": [
          "Nagios"
        ],
        "parameters": [
          {
            "name": "error",
            "in": "query",
            "description": "a string reference to notify on error",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "success",
            "in": "query",
            "description": "a string reference to notify on success",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "jobName",
            "in": "query",
            "description": "the export job name as stored into Lilac export table",
            "schema": {
              "type": "string",
              "default": "nagios"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    },
    "/api/v2/testing/{test}": {
      "get": {
        "operationId": "testGetWithParam",
        "summary": "Test route with path parameter",
        "tags": [
          "Testing"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "test",
            "required": true,
            "description": "Someting like an optional ID",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "in": "query",
            "name": "q",
            "description": "A value to test",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200"
          },
          "401": {
            "$ref": "#/components/responses/401"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ResponseOK": {
        "type": "object",
        "properties": {
          "version": {
            "type": "string",
            "example": "2.0"
          },
          "code": {
            "type": "integer",
            "example": 200
          },
          "message": {
            "type": "string",
            "example": "200 OK"
          },
          "status": {
            "type": "string",
            "example": "authorized"
          },
          "result": {
            "type": "array",
            "items": {
              "type": "object"
            }
          }
        }
      },
      "ResponseUnauthorized": {
        "type": "object",
        "properties": {
          "version": {
            "type": "string",
            "example": "2.0"
          },
          "code": {
            "type": "integer",
            "example": 401
          },
          "message": {
            "type": "string",
            "example": "401 Unauthorized"
          },
          "status": {
            "type": "string",
            "example": "unauthorized"
          }
        }
      },
      "NagiosRessource": {
        "type": "object",
        "properties": {
          "resources": {
            "type": "object",
            "example": {
              "User1": "value1",
              "User9": "value9"
            }
          }
        }
      },
      "HostBase": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "hostName": {
            "type": "string",
            "description": "a string of a *unique* hostname"
          },
          "exportConfiguration": {
            "type": "boolean",
            "default": false,
            "description": "force the execution of Lilac exporter after Contact creation"
          }
        }
      },
      "Host": {
        "allOf": [
          {
            "$ref": "#/components/schemas/HostBase"
          }
        ],
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "templateHostName": {
            "type": "string",
            "description": "a string of a *unique* hostname",
            "default": "GENERIC_HOST"
          },
          "hostIp": {
            "type": "string",
            "description": "a string of the IP address of the host. Can be a CIDR IP"
          },
          "hostAlias": {
            "type": "string",
            "description": "a string containing a *alias* or a *description* of the host",
            "default": ""
          },
          "contactName": {
            "type": "string",
            "description": "an optional Lilac ContactName associated with this host",
            "default": null
          },
          "contactGroupName": {
            "type": "string",
            "description": "an optional Lilac ContactGroupName associated with this host",
            "default": null
          }
        }
      },
      "HostCreate": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Host"
          }
        ],
        "required": [
          "templateHostName",
          "hostName",
          "hostIp"
        ]
      },
      "HostUpdate": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Host"
          }
        ],
        "properties": {
          "newHostName": {
            "type": "string",
            "description": "a new name for the host",
            "default": null
          }
        },
        "required": [
          "hostName"
        ],
        "minProperties": 2
      }
    },
    "responses": {
      "200": {
        "description": "OK",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ResponseOK"
            }
          }
        }
      },
      "201": {
        "description": "OK",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ResponseOK"
            }
          }
        }
      },
      "401": {
        "description": "unauthorized",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ResponseUnauthorized"
            }
          }
        }
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  }
}